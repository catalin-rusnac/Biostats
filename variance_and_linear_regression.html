<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variance and Linear Regression Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .sliders-container {
            display: flex;
            justify-content: flex-start;
            margin: 20px 0;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            align-self: center;
        }
        .slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 5px;
        }
        label {
            margin: 5px 0;
            font-weight: bold;
            text-align: center;
            order: 2;
        }
        input[type="range"] {
            appearance: slider-vertical;
            -webkit-appearance: slider-vertical;
            width: 30px;
            height: 200px;
            margin: 5px 0;
            writing-mode: bt-lr;
            -webkit-writing-mode: bt-lr;
            order: 1;
        }
        .value-display {
            display: block;
            margin: 5px 0;
            text-align: center;
            font-weight: bold;
            min-width: 40px;
            order: 0;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f5e9;
            border-radius: 4px;
        }
        .result p {
            margin: 5px 0;
        }
        .chart-container {
            margin-top: 20px;
            height: 300px;
        }
        .data-table {
            width: auto;
            min-width: 200px;
            border-collapse: collapse;
            margin-top: 0;
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 8px 15px;
            text-align: center;
            background-color: white;
        }
        .data-table th {
            background-color: #f2f2f2;
        }
        .formula {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
        }
        .formula .description {
            color: #666;
            font-style: italic;
            margin-bottom: 15px;
        }
        .main-content {
            display: flex;
            gap: 20px;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Variance and Covariance Calculator</h1>
        <div class="main-content">
            <div class="sliders-container">
                <div class="slider-container">
                    <span class="value-display" id="value1">Y=5.0</span>
                    <input type="range" min="0" max="10" value="5" step="0.1" class="slider" id="slider1">
                    <label>X=1</label>
                </div>
                <div class="slider-container">
                    <span class="value-display" id="value2">Y=5.0</span>
                    <input type="range" min="0" max="10" value="5" step="0.1" class="slider" id="slider2">
                    <label>X=2</label>
                </div>
                <div class="slider-container">
                    <span class="value-display" id="value3">Y=5.0</span>
                    <input type="range" min="0" max="10" value="5" step="0.1" class="slider" id="slider3">
                    <label>X=3</label>
                </div>
                <div class="slider-container">
                    <span class="value-display" id="value4">Y=5.0</span>
                    <input type="range" min="0" max="10" value="5" step="0.1" class="slider" id="slider4">
                    <label>X=4</label>
                </div>
                <div class="slider-container">
                    <span class="value-display" id="value5">Y=5.0</span>
                    <input type="range" min="0" max="10" value="5" step="0.1" class="slider" id="slider5">
                    <label>X=5</label>
                </div>
            </div>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>X</th>
                        <th>Y</th>
                    </tr>
                </thead>
                <tbody id="dataTableBody">
                </tbody>
            </table>
        </div>

        <div class="formula">
            <h3>Mean Calculation</h3>
            <p class="description">The mean (average) represents the central value of the Y data points. It's calculated by summing all values and dividing by the number of points.</p>
            <p>Formula: \(\bar{y} = \frac{1}{n}\sum_{i=1}^{n} y_i\)</p>
            <p>Current calculation: \(\bar{y} = \frac{1}{5}\sum_{i=1}^{5} y_i = \frac{1}{5}(y_1 + y_2 + y_3 + y_4 + y_5)\)</p>
            <p id="meanCalculation">\(\bar{y} = \frac{1}{5}(5 + 5 + 5 + 5 + 5) = 5\)</p>
        </div>

        <div class="formula">
            <h3>Variance Calculation</h3>
            <p class="description">Variance measures how far the Y values are spread out from their mean. A higher variance indicates that the data points are more dispersed.</p>
            <p>Formula: \(s^2_y = \frac{1}{n}\sum_{i=1}^{n} (y_i - \bar{y})^2\)</p>
            <p>Current calculation: \(s^2_y = \frac{1}{5}\sum_{i=1}^{5} (y_i - \bar{y})^2\)</p>
            <p id="varianceCalculation">\(s^2_y = \frac{1}{5}[(5-5)^2 + (5-5)^2 + (5-5)^2 + (5-5)^2 + (5-5)^2] = 0\)</p>
        </div>

        <div class="formula">
            <h3>Covariance Calculation</h3>
            <p class="description">Covariance shows how X and Y values change together. A positive covariance means they tend to increase together, while negative means they move in opposite directions.</p>
            <p>Formula: \(s_{xy} = \frac{1}{n}\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})\)</p>
            <p>Current calculation: \(s_{xy} = \frac{1}{5}\sum_{i=1}^{5} (x_i - 3)(y_i - \bar{y})\)</p>
            <p id="covarianceCalculation">\(s_{xy} = \frac{1}{5}[(1-3)(5-5) + (2-3)(5-5) + (3-3)(5-5) + (4-3)(5-5) + (5-3)(5-5)] = 0\)</p>
        </div>

        <div class="formula">
            <h3>Correlation Calculation</h3>
            <p class="description">Correlation measures the strength and direction of the linear relationship between X and Y. It ranges from -1 (perfect negative correlation) to 1 (perfect positive correlation).</p>
            <p>Formula: \(r_{xy} = \frac{s_{xy}}{s_x s_y}\)</p>
            <p>Where:</p>
            <ul>
                <li>\(s_{xy}\) is the covariance between X and Y</li>
                <li>\(s_x = \sqrt{s^2_x}\) is the standard deviation of X</li>
                <li>\(s_y = \sqrt{s^2_y}\) is the standard deviation of Y</li>
            </ul>
            <p id="correlationCalculation">\(r_{xy} = \frac{0}{\sqrt{2.5} \times \sqrt{0}} = 0\)</p>
        </div>

        <div class="formula">
            <h3>Linear Regression Fit</h3>
            <p class="description">The regression line represents the best linear fit to the data points. The slope (b) shows how much Y changes for each unit change in X, while the intercept (a) is the Y value when X is zero.</p>
            <p>Formula: \(y = a + bx\)</p>
            <p>Where:</p>
            <ul>
                <li>\(b = \frac{s_{xy}}{s^2_x}\) is the slope</li>
                <li>\(a = \bar{y} - b\bar{x}\) is the y-intercept</li>
            </ul>
            <p id="regressionCalculation">\(y = 5 + 0x\)</p>
        </div>

        <div class="formula">
            <h3>Residuals Analysis</h3>
            <p class="description">Residuals are the differences between the actual Y values and the predicted Y values from the regression line. They help us understand how well the regression line fits the data.</p>
            <p>Formula: \(e_i = y_i - \hat{y}_i\)</p>
            <p>Where:</p>
            <ul>
                <li>\(y_i\) is the actual Y value</li>
                <li>\(\hat{y}_i = a + bx_i\) is the predicted Y value</li>
                <li>\(e_i\) is the residual (error)</li>
            </ul>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>X</th>
                        <th>Actual Y</th>
                        <th>Predicted Y</th>
                        <th>Residual</th>
                    </tr>
                </thead>
                <tbody id="residualsTableBody">
                </tbody>
            </table>
            <p>Sum of Squared Residuals (SSR): <span id="ssr">0.00</span></p>
        </div>

        <div class="result">
            <p>Mean of X: <span id="meanX">3.0</span></p>
            <p>Mean of Y: <span id="meanY">5.0</span></p>
            <p>Variance of X: <span id="varX">2.5</span></p>
            <p>Variance of Y: <span id="varY">0.0</span></p>
            <p>Covariance(X,Y): <span id="covXY">0.0</span></p>
            <p>Correlation(X,Y): <span id="corrXY">0.0</span></p>
            <p>Slope (b): <span id="slope">0.0</span></p>
            <p>Y-intercept (a): <span id="intercept">5.0</span></p>
        </div>
        <div class="chart-container">
            <canvas id="scatterPlot"></canvas>
        </div>
    </div>

    <script>
        let scatterChart = null;

        function calculateStatistics(xValues, yValues) {
            const n = xValues.length;
            
            // Calculate means
            const meanX = xValues.reduce((a, b) => a + b, 0) / n;
            const meanY = yValues.reduce((a, b) => a + b, 0) / n;
            
            // Calculate variances
            const varX = xValues.reduce((sum, x) => sum + Math.pow(x - meanX, 2), 0) / n;
            const varY = yValues.reduce((sum, y) => sum + Math.pow(y - meanY, 2), 0) / n;
            
            // Calculate covariance
            const covXY = xValues.reduce((sum, x, i) => sum + (x - meanX) * (yValues[i] - meanY), 0) / n;
            
            // Calculate correlation
            const corrXY = covXY / (Math.sqrt(varX) * Math.sqrt(varY));

            // Calculate regression coefficients
            const slope = covXY / varX;
            const intercept = meanY - slope * meanX;

            // Calculate residuals
            const predictedY = xValues.map(x => intercept + slope * x);
            const residuals = yValues.map((y, i) => y - predictedY[i]);
            const ssr = residuals.reduce((sum, r) => sum + r * r, 0);
            
            return {
                meanX, meanY, varX, varY, covXY, corrXY, slope, intercept,
                predictedY, residuals, ssr
            };
        }

        function updateValues() {
            const xValues = [1, 2, 3, 4, 5];
            const yValues = [];
            
            // Update table
            const tableBody = document.getElementById('dataTableBody');
            tableBody.innerHTML = '';
            
            for (let i = 1; i <= 5; i++) {
                const value = parseFloat(document.getElementById(`slider${i}`).value);
                document.getElementById(`value${i}`).textContent = `Y=${value.toFixed(1)}`;
                yValues.push(value);
                
                // Add row to table
                const row = tableBody.insertRow();
                row.insertCell(0).textContent = i;
                row.insertCell(1).textContent = value.toFixed(1);
            }

            // Calculate statistics
            const stats = calculateStatistics(xValues, yValues);
            
            // Update regression calculation display
            const regressionCalc = `\\[y = ${stats.intercept.toFixed(2)} + ${stats.slope.toFixed(2)}x\\]`;
            document.getElementById('regressionCalculation').innerHTML = regressionCalc;

            // Update statistics display
            document.getElementById('meanX').textContent = stats.meanX.toFixed(2);
            document.getElementById('meanY').textContent = stats.meanY.toFixed(2);
            document.getElementById('varX').textContent = stats.varX.toFixed(2);
            document.getElementById('varY').textContent = stats.varY.toFixed(2);
            document.getElementById('covXY').textContent = stats.covXY.toFixed(2);
            document.getElementById('corrXY').textContent = stats.corrXY.toFixed(2);
            document.getElementById('slope').textContent = stats.slope.toFixed(2);
            document.getElementById('intercept').textContent = stats.intercept.toFixed(2);

            // Update mean calculation display
            const meanCalc = `\\[\\bar{y} = \\frac{1}{5}(${yValues.map(v => v.toFixed(1)).join(' + ')}) = ${stats.meanY.toFixed(2)}\\]`;
            document.getElementById('meanCalculation').innerHTML = meanCalc;

            // Update variance calculation display
            const varianceTerms = yValues.map(y => `(${y.toFixed(1)}-${stats.meanY.toFixed(1)})^2`).join(' + ');
            const varianceCalc = `\\[s^2_y = \\frac{1}{5}[${varianceTerms}] = ${stats.varY.toFixed(2)}\\]`;
            document.getElementById('varianceCalculation').innerHTML = varianceCalc;

            // Update covariance calculation display
            const covarianceTerms = xValues.map((x, i) => 
                `(${x}-${stats.meanX.toFixed(1)})(${yValues[i].toFixed(1)}-${stats.meanY.toFixed(1)})`
            ).join(' + ');
            const covarianceCalc = `\\[s_{xy} = \\frac{1}{5}[${covarianceTerms}] = ${stats.covXY.toFixed(2)}\\]`;
            document.getElementById('covarianceCalculation').innerHTML = covarianceCalc;

            // Update correlation calculation display
            const correlationCalc = `\\[r_{xy} = \\frac{${stats.covXY.toFixed(2)}}{\\sqrt{${stats.varX.toFixed(2)}} \\times \\sqrt{${stats.varY.toFixed(2)}}} = ${stats.corrXY.toFixed(2)}\\]`;
            document.getElementById('correlationCalculation').innerHTML = correlationCalc;

            // Update residuals table
            const residualsTableBody = document.getElementById('residualsTableBody');
            residualsTableBody.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const row = residualsTableBody.insertRow();
                row.insertCell(0).textContent = xValues[i];
                row.insertCell(1).textContent = yValues[i].toFixed(2);
                row.insertCell(2).textContent = stats.predictedY[i].toFixed(2);
                row.insertCell(3).textContent = stats.residuals[i].toFixed(2);
            }

            // Update SSR
            document.getElementById('ssr').textContent = stats.ssr.toFixed(2);

            MathJax.typeset();

            // Update scatter plot with regression line
            if (scatterChart) {
                scatterChart.destroy();
            }

            const ctx = document.getElementById('scatterPlot').getContext('2d');
            scatterChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Data Points',
                        data: xValues.map((x, i) => ({x, y: yValues[i]})),
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgb(54, 162, 235)',
                        borderWidth: 1,
                        pointRadius: 8
                    },
                    {
                        label: 'Regression Line',
                        data: [
                            {x: 0, y: stats.intercept},
                            {x: 6, y: stats.intercept + stats.slope * 6}
                        ],
                        type: 'line',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 0,
                        showLine: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: 0,
                            max: 6,
                            title: {
                                display: true,
                                text: 'X'
                            }
                        },
                        y: {
                            type: 'linear',
                            min: 0,
                            max: 10,
                            title: {
                                display: true,
                                text: 'Y'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    }
                }
            });
        }

        // Add event listeners to all sliders
        for (let i = 1; i <= 5; i++) {
            document.getElementById(`slider${i}`).addEventListener('input', updateValues);
        }

        // Initial calculation
        updateValues();
    </script>
</body>
</html> 